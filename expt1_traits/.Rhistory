####################
# fit a linear model where mu at 25C predicts mu at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25, # fixed effect only
data = resist_mu)
tmpLMM0_mu <- glmmTMB(mu_Temp40 ~ (1|Species), # random effect NULL MODEL!!!
data = resist_mu)
tmpLMM_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Species),
data = resist_mu)
tmpLMM2_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Inoculum),
data = resist_mu)
tmpLMM3_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Species) + (1|Inoculum),
data = resist_mu)
BIC(tmpLM0_mu_25, tmpLMM0_mu, tmpLMM_mu_25, tmpLMM2_mu_25, tmpLMM3_mu_25) %>% arrange(BIC)
# the null model with random effect of species is the best model
anova(tmpLMM0_mu, tmpLMM_mu_25)
rm(tmpLM0_mu_25, tmpLMM2_mu_25, tmpLMM3_mu_25)
# BUT we are NOT INTERESTED in the null model with only random effect of species!!!
# okay so it seems that my intuition was right that a model with random effect of species is best. Let's plot it & see it's effect sizes and explanatory power
tmp_resist_mu <- cbind(resist_mu,
predicted = predict(tmpLMM_mu_25, type="response"),
resid = residuals(tmpLMM_mu_25))
ggplot(tmp_resist_mu,
aes(x=mu_Temp25, y=mu_Temp40, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 25C", y="Growth rate at 40C")
summary(tmpLMM_mu_25)
emmeans(tmpLMM_mu_25, ~ mu_Temp25, type="response")
efronRSquared(residual = tmp_resist_mu$resid,
predicted = tmp_resist_mu$predicted,
statistic = "EfronRSquared")
# hahhahhaha, I love this r-squared value! I guess the random effect of species is actually a great fit. We already saw this from the BIC model comparison above.
####################
# mu at 30C predicting mu at 40C
####################
# fit a linear model where mu at 30C predicts mu at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30, # fixed effect only
data = resist_mu)
tmpLMM0_mu <- glmmTMB(mu_Temp40 ~ (1|Species), # random effect NULL MODEL!!!
data = resist_mu)
tmpLMM_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Species),
data = resist_mu)
tmpLMM2_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Inoculum),
data = resist_mu)
tmpLMM3_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Species) + (1|Inoculum),
data = resist_mu)
BIC(tmpLM0_mu_30, tmpLMM0_mu_30, tmpLMM_mu_30, tmpLMM2_mu_30, tmpLMM3_mu_30) %>% arrange(BIC)
resist_mu <- Dil_growthrates.df %>% select(Sample, Species, Temp, Inoculum, mu) %>%
pivot_wider(names_from = Temp, names_prefix="mu_Temp", values_from = mu)
####################
# mu at 25C predicting mu at 40C
####################
# fit a linear model where mu at 25C predicts mu at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25, # fixed effect only
data = resist_mu)
tmpLMM0_mu <- glmmTMB(mu_Temp40 ~ (1|Species), # random effect NULL MODEL!!!
data = resist_mu)
tmpLMM_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Species),
data = resist_mu)
tmpLMM2_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Inoculum),
data = resist_mu)
tmpLMM3_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Species) + (1|Inoculum),
data = resist_mu)
BIC(tmpLM0_mu_25, tmpLMM0_mu, tmpLMM_mu_25, tmpLMM2_mu_25, tmpLMM3_mu_25) %>% arrange(BIC)
# the null model with random effect of species is the best model
anova(tmpLMM0_mu, tmpLMM_mu_25)
rm(tmpLM0_mu_25, tmpLMM2_mu_25, tmpLMM3_mu_25)
# BUT we are NOT INTERESTED in the null model with only random effect of species!!!
# okay so it seems that my intuition was right that a model with random effect of species is best. Let's plot it & see it's effect sizes and explanatory power
tmp_resist_mu <- cbind(resist_mu,
predicted = predict(tmpLMM_mu_25, type="response"),
resid = residuals(tmpLMM_mu_25))
ggplot(tmp_resist_mu,
aes(x=mu_Temp25, y=mu_Temp40, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 25C", y="Growth rate at 40C")
summary(tmpLMM_mu_25)
emmeans(tmpLMM_mu_25, ~ mu_Temp25, type="response")
efronRSquared(residual = tmp_resist_mu$resid,
predicted = tmp_resist_mu$predicted,
statistic = "EfronRSquared")
# hahhahhaha, I love this r-squared value! I guess the random effect of species is actually a great fit. We already saw this from the BIC model comparison above.
####################
# mu at 30C predicting mu at 40C
####################
# fit a linear model where mu at 30C predicts mu at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30, # fixed effect only
data = resist_mu)
tmpLMM0_mu <- glmmTMB(mu_Temp40 ~ (1|Species), # random effect NULL MODEL!!!
data = resist_mu)
tmpLMM_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Species),
data = resist_mu)
tmpLMM2_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Inoculum),
data = resist_mu)
tmpLMM3_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Species) + (1|Inoculum),
data = resist_mu)
BIC(tmpLM0_mu_30, tmpLMM0_mu, tmpLMM_mu_30, tmpLMM2_mu_30, tmpLMM3_mu_30) %>% arrange(BIC)
# the null model with random effect of species is the best model
anova(tmpLMM0_mu, tmpLMM_mu_30)
rm(tmpLM0_mu_30, tmpLMM0_mu, tmpLMM2_mu_30, tmpLMM3_mu_30)
# BUT we are NOT INTERESTED in the null model with only random effect of species!!!
# okay so it seems that my intuition was right that a model with random effect of species is best. Let's plot it & see it's effect sizes and explanatory power
tmp_resist_mu <- cbind(resist_mu,
predicted = predict(tmpLMM_mu_25, type="response"),
resid = residuals(tmpLMM_mu_25))
ggplot(tmp_resist_mu,
aes(x=mu_Temp25, y=mu_Temp40, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 25C", y="Growth rate at 40C")
summary(tmpLMM_mu_25)
emmeans(tmpLMM_mu_25, ~ mu_Temp25, type="response")
efronRSquared(residual = tmp_resist_mu$resid,
predicted = tmp_resist_mu$predicted,
statistic = "EfronRSquared")
ggplot(resist_mu,
aes(x=mu_Temp30, y=mu_Temp40, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 30C", y="Growth rate at 40C")
# stats: THIS MODEL SHOULD HAVE AT LEAST RANDOM EFFECT OF SPECIES!!
summary(lm(mu_Temp40 ~ mu_Temp30, data=resist_mu))
resist_CFU <- inner_join(resist_mu %>% select(-mu_Temp35, -mu_Temp40),
CFU_survival.df %>% filter(Temp == 40) %>% select(-Shape, -temp_as_factor),
by = c("Sample", "Species", "Inoculum"))
ggplot(resist_CFU,
aes(x=mu_Temp25, y=mean_surviv, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 25C", y="Relative CFU at 40C")
# stats: THIS MODEL SHOULD HAVE A RANDOM EFFECT OF SPECIES!!
summary(lm(mean_surviv ~ mu_Temp25, data=resist_CFU))
ggplot(resist_CFU,
aes(x=mu_Temp30, y=mean_surviv, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 30C", y="Relative CFU at 40C")
# stats: THIS MODEL SHOULD HAVE A RANDOM EFFECT OF SPECIES!!
summary(lm(mean_surviv ~ mu_Temp30, data=resist_CFU))
resist_mu <- Dil_growthrates.df %>% select(Sample, Species, Temp, Inoculum, mu) %>%
pivot_wider(names_from = Temp, names_prefix="mu_Temp", values_from = mu)
####################
# mu at 25C predicting mu at 40C
####################
# fit a linear model where mu at 25C predicts mu at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25, # fixed effect only
data = resist_mu)
tmpLMM0_mu <- glmmTMB(mu_Temp40 ~ (1|Species), # random effect NULL MODEL!!!
data = resist_mu)
tmpLMM_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Species),
data = resist_mu)
tmpLMM2_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Inoculum),
data = resist_mu)
tmpLMM3_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Species) + (1|Inoculum),
data = resist_mu)
BIC(tmpLM0_mu_25, tmpLMM0_mu, tmpLMM_mu_25, tmpLMM2_mu_25, tmpLMM3_mu_25) %>% arrange(BIC)
# the null model with random effect of species is the best model
anova(tmpLMM0_mu, tmpLMM_mu_25)
rm(tmpLM0_mu_25, tmpLMM2_mu_25, tmpLMM3_mu_25)
# BUT we are NOT INTERESTED in the null model with only random effect of species!!!
# okay so it seems that my intuition was right that a model with random effect of species is best. Let's plot it & see it's effect sizes and explanatory power
tmp_resist_mu <- cbind(resist_mu,
predicted = predict(tmpLMM_mu_25, type="response"),
resid = residuals(tmpLMM_mu_25))
ggplot(tmp_resist_mu,
aes(x=mu_Temp25, y=mu_Temp40, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 25C", y="Growth rate at 40C")
summary(tmpLMM_mu_25)
emmeans(tmpLMM_mu_25, ~ mu_Temp25, type="response")
efronRSquared(residual = tmp_resist_mu$resid,
predicted = tmp_resist_mu$predicted,
statistic = "EfronRSquared")
# hahhahhaha, I love this r-squared value! I guess the random effect of species is actually a great fit. We already saw this from the BIC model comparison above.
rm(tmpLMM_mu_25, tmp_resist_mu)
####################
# mu at 30C predicting mu at 40C
####################
# fit a linear model where mu at 30C predicts mu at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30, # fixed effect only
data = resist_mu)
tmpLMM0_mu <- glmmTMB(mu_Temp40 ~ (1|Species), # random effect NULL MODEL!!!
data = resist_mu)
tmpLMM_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Species),
data = resist_mu)
tmpLMM2_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Inoculum),
data = resist_mu)
tmpLMM3_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Species) + (1|Inoculum),
data = resist_mu)
BIC(tmpLM0_mu_30, tmpLMM0_mu, tmpLMM_mu_30, tmpLMM2_mu_30, tmpLMM3_mu_30) %>% arrange(BIC)
# the null model with random effect of species is the best model
anova(tmpLMM0_mu, tmpLMM_mu_30)
rm(tmpLM0_mu_30, tmpLMM0_mu, tmpLMM2_mu_30, tmpLMM3_mu_30)
# BUT we are NOT INTERESTED in the null model with only random effect of species!!!
# okay so it seems that my intuition was right that a model with random effect of species is best. Let's plot it & see it's effect sizes and explanatory power
tmp_resist_mu <- cbind(resist_mu,
predicted = predict(tmpLMM_mu_25, type="response"),
resid = residuals(tmpLMM_mu_25))
resist_mu <- Dil_growthrates.df %>% select(Sample, Species, Temp, Inoculum, mu) %>%
pivot_wider(names_from = Temp, names_prefix="mu_Temp", values_from = mu)
####################
# mu at 25C predicting mu at 40C
####################
# fit a linear model where mu at 25C predicts mu at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25, # fixed effect only
data = resist_mu)
tmpLMM0_mu <- glmmTMB(mu_Temp40 ~ (1|Species), # random effect NULL MODEL!!!
data = resist_mu)
tmpLMM_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Species),
data = resist_mu)
tmpLMM2_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Inoculum),
data = resist_mu)
tmpLMM3_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Species) + (1|Inoculum),
data = resist_mu)
BIC(tmpLM0_mu_25, tmpLMM0_mu, tmpLMM_mu_25, tmpLMM2_mu_25, tmpLMM3_mu_25) %>% arrange(BIC)
# the null model with random effect of species is the best model
anova(tmpLMM0_mu, tmpLMM_mu_25)
rm(tmpLM0_mu_25, tmpLMM2_mu_25, tmpLMM3_mu_25)
# BUT we are NOT INTERESTED in the null model with only random effect of species!!!
# okay so it seems that my intuition was right that a model with random effect of species is best. Let's plot it & see it's effect sizes and explanatory power
tmp_resist_mu <- cbind(resist_mu,
predicted = predict(tmpLMM_mu_25, type="response"),
resid = residuals(tmpLMM_mu_25))
ggplot(tmp_resist_mu,
aes(x=mu_Temp25, y=mu_Temp40, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 25C", y="Growth rate at 40C")
summary(tmpLMM_mu_25)
emmeans(tmpLMM_mu_25, ~ mu_Temp25, type="response")
efronRSquared(residual = tmp_resist_mu$resid,
predicted = tmp_resist_mu$predicted,
statistic = "EfronRSquared")
# hahhahhaha, I love this r-squared value! I guess the random effect of species is actually a great fit. We already saw this from the BIC model comparison above.
rm(tmpLMM_mu_25, tmp_resist_mu)
####################
# mu at 30C predicting mu at 40C
####################
# fit a linear model where mu at 30C predicts mu at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30, # fixed effect only
data = resist_mu)
tmpLMM0_mu <- glmmTMB(mu_Temp40 ~ (1|Species), # random effect NULL MODEL!!!
data = resist_mu)
tmpLMM_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Species),
data = resist_mu)
tmpLMM2_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Inoculum),
data = resist_mu)
tmpLMM3_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Species) + (1|Inoculum),
data = resist_mu)
BIC(tmpLM0_mu_30, tmpLMM0_mu, tmpLMM_mu_30, tmpLMM2_mu_30, tmpLMM3_mu_30) %>% arrange(BIC)
# the null model with random effect of species is the best model
anova(tmpLMM0_mu, tmpLMM_mu_30)
rm(tmpLM0_mu_30, tmpLMM0_mu, tmpLMM2_mu_30, tmpLMM3_mu_30)
# BUT we are NOT INTERESTED in the null model with only random effect of species!!!
# okay so it seems that my intuition was right that a model with random effect of species is best. Let's plot it & see it's effect sizes and explanatory power
tmp_resist_mu <- cbind(resist_mu,
predicted = predict(tmpLMM_mu_30, type="response"),
resid = residuals(tmpLMM_mu_30))
ggplot(tmp_resist_mu,
aes(x=mu_Temp30, y=mu_Temp40, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 30C", y="Growth rate at 40C")
summary(tmpLMM_mu_30)
emmeans(tmpLMM_mu_30, ~ mu_Temp30, type="response")
efronRSquared(residual = tmp_resist_mu$resid,
predicted = tmp_resist_mu$predicted,
statistic = "EfronRSquared")
rm(tmpLMM_mu_30, tmp_resist_mu)
ggplot(resist_mu,
aes(x=mu_Temp30, y=mu_Temp40, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 30C", y="Growth rate at 40C")
# stats: THIS MODEL SHOULD HAVE AT LEAST RANDOM EFFECT OF SPECIES!!
summary(lm(mu_Temp40 ~ mu_Temp30, data=resist_mu))
resist_CFU <- inner_join(resist_mu %>% select(-mu_Temp35, -mu_Temp40),
CFU_survival.df %>% filter(Temp == 40) %>% select(-Shape, -temp_as_factor),
by = c("Sample", "Species", "Inoculum"))
ggplot(resist_CFU,
aes(x=mu_Temp25, y=mean_surviv, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 25C", y="Relative CFU at 40C")
# stats: THIS MODEL SHOULD HAVE A RANDOM EFFECT OF SPECIES!!
summary(lm(mean_surviv ~ mu_Temp25, data=resist_CFU))
ggplot(resist_CFU,
aes(x=mu_Temp30, y=mean_surviv, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 30C", y="Relative CFU at 40C")
# stats: THIS MODEL SHOULD HAVE A RANDOM EFFECT OF SPECIES!!
summary(lm(mean_surviv ~ mu_Temp30, data=resist_CFU))
resist_CFU <- inner_join(resist_mu %>% select(-mu_Temp35, -mu_Temp40),
CFU_survival.df %>% filter(Temp == 40) %>% select(-Shape, -temp_as_factor),
by = c("Sample", "Species", "Inoculum"))
# fit a linear model where mu at 25C predicts relative CFU at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_CFU_25 <- glmmTMB(mean_surviv ~ mu_Temp25, # fixed effect only
data = resist_CFU)
tmpLMM0_CFU <- glmmTMB(mean_surviv ~ (1|Species), # random effect NULL MODEL!!!
data = resist_CFU)
tmpLMM_CFU_25 <- glmmTMB(mean_surviv ~ mu_Temp25 + (1|Species),
data = resist_CFU)
tmpLMM2_CFU_25 <- glmmTMB(mean_surviv ~ mu_Temp25 + (1|Inoculum),
data = resist_CFU)
tmpLMM3_CFU_25 <- glmmTMB(mean_surviv ~ mu_Temp25 + (1|Species) + (1|Inoculum),
data = resist_CFU)
BIC(tmpLM0_CFU_25, tmpLMM0_CFU, tmpLMM_CFU_25, tmpLMM2_CFU_25, tmpLMM3_CFU_25) %>% arrange(BIC)
# the null model with random effect of species is the best model
anova(tmpLMM0_CFU, tmpLMM_CFU_25)
rm(tmpLM0_CFU_25, tmpLMM2_CFU_25, tmpLMM3_CFU_25)
# BUT we are NOT INTERESTED in the null model with only random effect of species!!!
# okay so it seems that my intuition was right that a model with random effect of species is best. Let's plot it & see it's effect sizes and explanatory power
tmp_resist_CFU <- cbind(resist_CFU,
predicted = predict(tmpLMM_CFU_25, type="response"),
resid = residuals(tmpLMM_CFU_25))
ggplot(tmp_resist_CFU,
aes(x=mu_Temp25, y=mean_surviv, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 25C", y="Relative CFU at 40C")
summary(tmpLMM_CFU_25)
emmeans(tmpLMM_CFU_25, ~ mu_Temp25, type="response")
efronRSquared(residual = tmp_resist_CFU$resid,
predicted = tmp_resist_CFU$predicted,
statistic = "EfronRSquared")
# fit a linear model where mu at 30C predicts relative CFU at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_CFU_30 <- glmmTMB(mean_surviv ~ mu_Temp30, # fixed effect only
data = resist_CFU)
tmpLMM_CFU_30 <- glmmTMB(mean_surviv ~ mu_Temp30 + (1|Species),
data = resist_CFU)
tmpLMM2_CFU_30 <- glmmTMB(mean_surviv ~ mu_Temp30 + (1|Inoculum),
data = resist_CFU)
tmpLMM3_CFU_30 <- glmmTMB(mean_surviv ~ mu_Temp30 + (1|Species) + (1|Inoculum),
data = resist_CFU)
BIC(tmpLM0_CFU_30, tmpLMM0_CFU, tmpLMM_CFU_30, tmpLMM2_CFU_30, tmpLMM3_CFU_30) %>% arrange(BIC)
# HA! finally the mixed model is at least as good as the null model!
anova(tmpLMM0_CFU, tmpLMM_CFU_30)
tmp_resist_CFU <- cbind(resist_CFU,
predicted = predict(tmpLMM_CFU_30, type="response"),
resid = residuals(tmpLMM_CFU_30))
ggplot(tmp_resist_CFU,
aes(x=mu_Temp30, y=mean_surviv, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 30C", y="Relative CFU at 40C")
summary(tmpLMM_CFU_30)
pvalue(tmpLMM_CFU_30)
?emmeans
summary(tmpLMM_CFU_30)
emmeans(tmpLMM_CFU_30, ~ mu_Temp30, type="response")
efronRSquared(residual = tmp_resist_CFU$resid,
predicted = tmp_resist_CFU$predicted,
statistic = "EfronRSquared")
resist_mu <- Dil_growthrates.df %>% select(Sample, Species, Temp, Inoculum, mu) %>%
pivot_wider(names_from = Temp, names_prefix="mu_Temp", values_from = mu)
####################
# mu at 25C predicting mu at 40C
####################
# fit a linear model where mu at 25C predicts mu at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25, # fixed effect only
data = resist_mu)
tmpLMM0_mu <- glmmTMB(mu_Temp40 ~ (1|Species), # random effect NULL MODEL!!!
data = resist_mu)
tmpLMM_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Species),
data = resist_mu)
tmpLMM2_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Inoculum),
data = resist_mu)
tmpLMM3_mu_25 <- glmmTMB(mu_Temp40 ~ mu_Temp25 + (1|Species) + (1|Inoculum),
data = resist_mu)
BIC(tmpLM0_mu_25, tmpLMM0_mu, tmpLMM_mu_25, tmpLMM2_mu_25, tmpLMM3_mu_25) %>% arrange(BIC)
# the null model with random effect of species is the best model
anova(tmpLMM0_mu, tmpLMM_mu_25)
rm(tmpLM0_mu_25, tmpLMM2_mu_25, tmpLMM3_mu_25)
# BUT we are NOT INTERESTED in the null model with only random effect of species!!!
# okay so it seems that my intuition was right that a model with random effect of species is best. Let's plot it & see it's effect sizes and explanatory power
tmp_resist_mu <- cbind(resist_mu,
predicted = predict(tmpLMM_mu_25, type="response"),
resid = residuals(tmpLMM_mu_25))
ggplot(tmp_resist_mu,
aes(x=mu_Temp25, y=mu_Temp40, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 25C", y="Growth rate at 40C")
summary(tmpLMM_mu_25)
emmeans(tmpLMM_mu_25, ~ mu_Temp25, type="response")
efronRSquared(residual = tmp_resist_mu$resid,
predicted = tmp_resist_mu$predicted,
statistic = "EfronRSquared")
# hahhahhaha, I love this r-squared value! I guess the random effect of species is actually a great fit. We already saw this from the BIC model comparison above.
rm(tmpLMM_mu_25, tmp_resist_mu)
####################
# mu at 30C predicting mu at 40C
####################
# fit a linear model where mu at 30C predicts mu at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30, # fixed effect only
data = resist_mu)
tmpLMM0_mu <- glmmTMB(mu_Temp40 ~ (1|Species), # random effect NULL MODEL!!!
data = resist_mu)
tmpLMM_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Species),
data = resist_mu)
tmpLMM2_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Inoculum),
data = resist_mu)
tmpLMM3_mu_30 <- glmmTMB(mu_Temp40 ~ mu_Temp30 + (1|Species) + (1|Inoculum),
data = resist_mu)
BIC(tmpLM0_mu_30, tmpLMM0_mu, tmpLMM_mu_30, tmpLMM2_mu_30, tmpLMM3_mu_30) %>% arrange(BIC)
# the null model with random effect of species is the best model
anova(tmpLMM0_mu, tmpLMM_mu_30)
rm(tmpLM0_mu_30, tmpLMM0_mu, tmpLMM2_mu_30, tmpLMM3_mu_30)
# BUT we are NOT INTERESTED in the null model with only random effect of species!!!
# again my intuition was right. Let's plot & analyze the model of interest
tmp_resist_mu <- cbind(resist_mu,
predicted = predict(tmpLMM_mu_30, type="response"),
resid = residuals(tmpLMM_mu_30))
ggplot(tmp_resist_mu,
aes(x=mu_Temp30, y=mu_Temp40, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 30C", y="Growth rate at 40C")
summary(tmpLMM_mu_30)
emmeans(tmpLMM_mu_30, ~ mu_Temp30, type="response")
efronRSquared(residual = tmp_resist_mu$resid,
predicted = tmp_resist_mu$predicted,
statistic = "EfronRSquared")
# again, this great explanatory power is coming purely from the random effect of species
rm(tmpLMM_mu_30, tmp_resist_mu)
####################
# mu at 25C predicting relative CFU at 40C
####################
resist_CFU <- inner_join(resist_mu %>% select(-mu_Temp35, -mu_Temp40),
CFU_survival.df %>% filter(Temp == 40) %>% select(-Shape, -temp_as_factor),
by = c("Sample", "Species", "Inoculum"))
# fit a linear model where mu at 25C predicts relative CFU at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_CFU_25 <- glmmTMB(mean_surviv ~ mu_Temp25, # fixed effect only
data = resist_CFU)
tmpLMM0_CFU <- glmmTMB(mean_surviv ~ (1|Species), # random effect NULL MODEL!!!
data = resist_CFU)
tmpLMM_CFU_25 <- glmmTMB(mean_surviv ~ mu_Temp25 + (1|Species),
data = resist_CFU)
tmpLMM2_CFU_25 <- glmmTMB(mean_surviv ~ mu_Temp25 + (1|Inoculum),
data = resist_CFU)
tmpLMM3_CFU_25 <- glmmTMB(mean_surviv ~ mu_Temp25 + (1|Species) + (1|Inoculum),
data = resist_CFU)
BIC(tmpLM0_CFU_25, tmpLMM0_CFU, tmpLMM_CFU_25, tmpLMM2_CFU_25, tmpLMM3_CFU_25) %>% arrange(BIC)
# the null model with random effect of species is the best model
anova(tmpLMM0_CFU, tmpLMM_CFU_25)
rm(tmpLM0_CFU_25, tmpLMM2_CFU_25, tmpLMM3_CFU_25)
# BUT we are NOT INTERESTED in the null model with only random effect of species!!!
# again my intuition was right. Let's plot & analyze the model of interest
tmp_resist_CFU <- cbind(resist_CFU,
predicted = predict(tmpLMM_CFU_25, type="response"),
resid = residuals(tmpLMM_CFU_25))
ggplot(tmp_resist_CFU,
aes(x=mu_Temp25, y=mean_surviv, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 25C", y="Relative CFU at 40C")
summary(tmpLMM_CFU_25)
emmeans(tmpLMM_CFU_25, ~ mu_Temp25, type="response")
efronRSquared(residual = tmp_resist_CFU$resid,
predicted = tmp_resist_CFU$predicted,
statistic = "EfronRSquared")
# again, this high explanatory power is coming purely from the random effect of species
rm(tmpLMM_CFU_25, tmp_resist_CFU)
####################
# mu at 30C predicting relative CFU at 40C
####################
# fit a linear model where mu at 30C predicts relative CFU at 40C but with random effect of species ... (if we're here anyway, test if Inoculum has any effect)
tmpLM0_CFU_30 <- glmmTMB(mean_surviv ~ mu_Temp30, # fixed effect only
data = resist_CFU)
tmpLMM_CFU_30 <- glmmTMB(mean_surviv ~ mu_Temp30 + (1|Species),
data = resist_CFU)
tmpLMM2_CFU_30 <- glmmTMB(mean_surviv ~ mu_Temp30 + (1|Inoculum),
data = resist_CFU)
tmpLMM3_CFU_30 <- glmmTMB(mean_surviv ~ mu_Temp30 + (1|Species) + (1|Inoculum),
data = resist_CFU)
BIC(tmpLM0_CFU_30, tmpLMM0_CFU, tmpLMM_CFU_30, tmpLMM2_CFU_30, tmpLMM3_CFU_30) %>% arrange(BIC)
# HA! finally the mixed model is at least as good as the null model!
anova(tmpLMM0_CFU, tmpLMM_CFU_30)
rm(tmpLM0_CFU_30, tmpLMM2_CFU_30, tmpLMM3_CFU_30, tmpLMM0_CFU)
# great, now we are even justified to get rid of the null model :)
# Let's plot & analyze the top model
tmp_resist_CFU <- cbind(resist_CFU,
predicted = predict(tmpLMM_CFU_30, type="response"),
resid = residuals(tmpLMM_CFU_30))
ggplot(tmp_resist_CFU,
aes(x=mu_Temp30, y=mean_surviv, colour=Species, shape=Inoculum)) +
geom_point(alpha=0.5) +
geom_line(aes(y = predicted, group = Species)) +
scale_colour_manual(values=ALLsp_palette) +
labs(x="Growth rate at 30C", y="Relative CFU at 40C")
summary(tmpLMM_CFU_30)
# the trouble here is that the model is only very slightly significant and we probably need to correct for multiple testing...
emmeans(tmpLMM_CFU_30, ~ mu_Temp30, type="response")
# in fact, so slight that the effect size is not quite significant
efronRSquared(residual = tmp_resist_CFU$resid,
predicted = tmp_resist_CFU$predicted,
statistic = "EfronRSquared")
rm(tmpLMM_CFU_30, tmp_resist_CFU)
